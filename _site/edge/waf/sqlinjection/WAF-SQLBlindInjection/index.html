<!DOCTYPE html><html lang="en-GB"><head> <!-- General meta --><meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --><meta name="generator" content="Jekyll v3.8.5" /><meta property="og:title" content="WAF SQL Blind Injection" /><meta name="author" content="Jake Kim" /><meta property="og:locale" content="en_US" /><meta name="description" content="OWASP SQL Blind Injection 이전의 SQL Injection 공격은 SQL을 변경하여 원하는 데이터를 가져오게 하여 정보를 탈취하는 방법이다. 기존 공격 방법이 웹을 통하여 데이터베이스 메시지를 확인 할 수 있었다. 반면 메시지를 확인 할 수 없는 경우에는 Blind Injection 이라는 공격 방법을 통해 데이터를 탈취할 수 있다. 공격 방법은 SQL을 변경 하여 실행 하도록 하고 데이터 베이스 메시지 대신 서버로 부터 응답 결과 만을 보고 데이터를 탈취하는 방법 이다. 상자속에 든 물건을 알아보기 위해 손을 넣어서 만져보는 것처럼 보이지 않는 데이터를 알아보기 위해 다양한 공격을 하여 데이터를 탈취하는 것이다. 원하는 데이터를 탈취하기 위해 계속적으로 공격을 시도하여 결과를 비교하여 데이터를 탈취함으로 자동화 된 툴을 통해 공격이 이루어 진다. Blind SQL Injection - Boolean based SQL SQL 의 질의 결과가 참/거짓으로 하였을 때 서버의 반응으로 부터 데이터를 탈취하는 기술이다. 정상 요청의 경우 서버는 정상 반응을 하는 것을 확인 하고 변경된 질의를 하여 서버의 반응이 정상인지 아닌지를 보는 방법 이다. SQL injection과 유사하나 사용되는 SQL 의 패턴이 다르다. 원하는 데이터를 얻기 위해 하나씩 진행 하기 때문에 문자열 관련된 함수 (substr, limt 등)가 많이 사용 된다. Blind SQL Injection - Time based SQL SQL 의 결과를 볼 수 없을 때 사용 하는 공격 방법인 Blind SQL 의 패턴으로 시간을 이용하여 참/거짓을 구분 하는 공격 방법 이다. sleep 함수 등을 이용하여 데이터베이스의 종류 (mySQL의 경우 응답시간을 지연 시킬 수 있다)를 감지할 수 있고 해당 데이터베이스에 맞는 함수 IF, sleep 등을 이용하여 그 결과를 참인 경우 일정 시간 지연 되도록 하여 데이터를 탈취할 수 있다. SQL Blind Injection Detect SQL Bind injection 공격을 감지 하기 위해서는 WAF Policies 의 protection rules 에서 Blind SQL injections, SQL injection using sleep() or benchmark() 를 선택 하여 Action 으로 detect 를 하여 줍니다. (기존에 SQL injection 을 감지하기 위해 Classic SQL Injection probings, Common SQL Injects를 선택 하였다 만약 선택하지 않았다면 2개도 detect 하여 준다) 변경된 내용은 아직 적용되어 있지 않음으로 publish All 버튼을 클릭 하여 적용 하여 줍니다. 적용이 시작되면 Updating 상태가 되고 전체 WAF 서버에 변경 된 정책을 적용하게 되어 약간의 시간이 소요 된다. SQL Blind Injection - boolean based Attack SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 공격을 위해서는 정상적인 응답이 오는 경우를 알고 있어야 한다. 알고 있는 정보로는 1이라는 사용자가 있는 것을 알고 있음으로 1을 입력 후 Submit 을 눌러 보자. 아래 그림 처럼 1 이라는 사용자가 존재 한다는 것을 알 수 있다. 거짓인 데이터에 대해서 웹페이지의 반응을 보기 위해 아래와 같이 입력 하고 실행 해 준다. &#39; or &#39;1&#39;=&#39;2&#39; 위 그림처럼 거짓일 때는 User ID is MISSING from the database 라는 메시지가 출력 되는 것을 알 수 있다. 아래 문장을 입력 후 실행 하여 서버의 반응 보면 &#39; union select 1 # &#39; union select 1,2 # ’ union select 1,2 # 를 입력 하였을 때 참인 것을 볼 수 있다 이를 통해 실행 되는 SQL 의 Select 항목이 2개임을 알 수가 있다. 다음으로 데이터베이스 이름을 알기 위해 다음을 순서대로 입력 하고 실행 해 보자. 1&#39; and length(database()) =1 1&#39; and length(database()) =2 1&#39; and length(database()) =3 1&#39; and length(database()) =4 length(database())=4 일때 결과가 참인 것을 볼 수 있을 것이다. 이로서 데이터 베이스 이름의 길이가 4 라는 것을 알았고 다음을 입력 하여 데이터 베이스 이름을 유추 할 수 있다. 1&#39; and substr(database(),1,1) = &#39;a&#39; 1&#39; and substr(database(),1,1) = &#39;b&#39; 1&#39; and substr(database(),1,1) = &#39;c&#39; 1&#39; and substr(database(),1,1) = &#39;d&#39; d 에서 참으로 나오는 것을 볼 수 있으며 이로서 데이터 베이스 이름의 길이는 4 이고 첫 글자라 d 라는 것을 알수 있다. 이와 같은 방법으로 알고자 하는 정보를 입력 하여 맞는지 아닌지를 계속적으로 체크하면 원하는 데이터를 탈취 할 수 있다. 이후에 테이블 명, 갯수를 확인 하고 이름, 컬럼 정보를 알아보는 SQL 을 수행하여 전체 정보를 탈취 하게 된다. WAF의 SQL Blind Injection - boolean based 감지 WAF Policies에서 Metrics 를 보면 Detect 된 요청의 건수를 보여주는 대시보드를 볼 수 있다. 분단위로 WAF가 감지한 내용을 볼 수 있다. 상세 내용을 보기 위해 Logs 를 클릭 하여 조회 조건 중 Action 에서 Detect 를 선택 하고 조회 한다. Detect 된 리스트를 볼 수 있으며 상세 각 라인별로 간략한 내용을 볼 수 있다. 접근을 시도한 지역과 User Agent 즉, 브라우저 정보를 볼 수 있다. 상세한 내용을 보기 위한 View JSON 을 클릭 한다. &quot;protectionRuleDetections&quot;: { &quot;950001&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:\\\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...\&quot; at ARGS:id.&quot; }, &quot;950007&quot;: { &quot;Message&quot;: &quot;Blind SQL Injection Attack. Matched Data: substr found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:\\\\b(?:(?:s(?:ys\\\\.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|object|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect\\\\b.{0,40}\\\\b(?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|object)s|ysql\\\\.(db|user))|c(?:onstraint ...\&quot; at ARGS:id.&quot; }, &quot;959073&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...\&quot; at ARGS:id.&quot; }, &quot;981242&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 1/2. Matched attack string: [1&#39; and substr(databse(),1,1) = &#39;d&#39; ] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?(x?or|div|like|between|and)\\\\s*?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]?\\\\d)|(?:\\\\\\\\x(?:23|27|3d))|(?:^.?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]$)|(?:(?:^[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98\\\\\\\\]*?(?:[\\\\ ...\&quot; at ARGS:id.&quot; }, &quot;981243&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 2/2. Matched attack string: [1&#39; and substr(databse(),1,1) = &#39;d&#39; ] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?\\\\*.+(?:x?or|div|like|between|and|id)\\\\W*?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\d)|(?:\\\\^[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98])|(?:^[\\\\w\\\\s\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98-]+(?&lt;=and\\\\s)(?&lt;=or|xor ...\&quot; at ARGS:id.&quot; } }, 메시지를 살펴 보면 SQL Injection Attack 이 발생 하였으며 감지된 패턴이 id 파라미터에 1’ and substr(databse(),1,1) = ‘d’ 이 들어간 것이 감지 된 것을 알 수 있다. 또한 Blind SQL Injection Attack 으로 substr 이 감지 된 것을 볼 수 있다. 공격이 발생 하였을 때 한개의 패턴 만이 발생 하는 것보다 다수의 패턴이 동시에 사용 될 수 있으며 이 중 감지 되는 내용이 보여 지고 메시지 번호 등을 통해 정확한 내용을 검색 해 볼 수 있다. 다시 웹애플리케이션으로 돌아가 View Source를 클릭 하면 다음과 같은 코드로 작성되어 있음을 볼 수 있다. &lt;?php if( isset( $_GET[ &#39;Submit&#39; ] ) ) { // Get input $id = $_GET[ &#39;id&#39; ]; // Check database $getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;$id&#39;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $getid ); // Removed &#39;or die&#39; to suppress mysql errors // Get results $num = @mysqli_num_rows( $result ); // The &#39;@&#39; character suppresses errors if( $num &gt; 0 ) { // Feedback for end user echo &#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;; } else { // User wasn&#39;t found, so the page wasn&#39;t! header( $_SERVER[ &#39;SERVER_PROTOCOL&#39; ] . &#39; 404 Not Found&#39; ); // Feedback for end user echo &#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } ?&gt; SQL 실행이 $id 로 직접 웹페이지의 Query 파라미터를 받아 sql 문자열을 만든 후에 실행되며 실행 결과는 선택되는 레코드의 존재에 여부에 따라 메시지가 보여지는 것을 알 수 있다. 레코드가 있다 없다라는 정보를 통해 원하는 정보를 탈 취 할 수 있는 취약한 코드가 되는 것이다. 취약성점을 방지 하기 위해 코드를 수정 하거나 WAF 에서 감지 하여 공격자 정보를 파악 하고 Block 하는 조취를 하는 것이 필요하다 Blind SQL Injection - Time based SQL Attack SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 해당 페이지는 조회 결과의 유무에 따라 보여지는 메시지가 달라 boolean 을 이용한 공격이 가능하지만 시간을 이용한 공격을 위해 메시지를 볼 수 없는 것으로 가정 한다. 우선 다음과 같이 입력하여 1’ and sleep(15) # 한 후 Submit 을 클릭 하여 보면 응답 시간이 느리게 오는 것을 알 수 있다. 이를 통해 웹 애플리케이션이 사용하는 데이터베이스가 mySQL 인것을 알 수 있다. 데이터 베이스 명을 알아 보기 위해 다음을 입력 하여 실행 하여 보자. 위 그림처럼 거짓일 때는 User ID is MISSING from the database 라는 메시지가 출력 되는 것을 알 수 있다. 1&#39; and IF (length(database()) =1, sleep(15),0) # 1&#39; and IF (length(database()) =2, sleep(15),0) # 1&#39; and IF (length(database()) =3, sleep(15),0) # 1&#39; and IF (length(database()) =4, sleep(15),0) # 응답 시간이 1’ and IF (length(database()) =4, sleep(15),0) # 일 때 느려지는 것을 확인 할 수 있다. 이를 통해 데이터 베이스 이름의 길이가 4라는 것을 알 수 있다. WAF의 SQL Blind Injection - Time based 감지 WAF 의 Metric 에서 detect 항목이 추가된 것을 확인 할 수 있으며 Logs 에서 메시지를 확인 하여 보면 다른 Detect 항목과 동일 하게 클라이언트 정보 (지역, 브라우저)를 볼 수 있다. 자세한 정보를 보기 위해 View JSON 을 클릭 하여 보면 다음 메시지를 확인 할 수 있다. &quot;protectionRuleDetections&quot;: { &quot;950001&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1&#39; and IF (length(database()) =4, sleep(15),0) #&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:\\\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...\&quot; at ARGS:id.&quot; }, &quot;959073&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1&#39; and IF (length(database()) =4, sleep(15),0) #&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...\&quot; at ARGS:id.&quot; }, &quot;981243&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 2/2. Matched attack string: [1&#39; and IF (length(database()) =4, sleep(15),0) #] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?\\\\*.+(?:x?or|div|like|between|and|id)\\\\W*?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\d)|(?:\\\\^[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98])|(?:^[\\\\w\\\\s\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98-]+(?&lt;=and\\\\s)(?&lt;=or|xor ...\&quot; at ARGS:id.&quot; }, &quot;981272&quot;: { &quot;Message&quot;: &quot;Detects blind sqli tests using sleep() or benchmark().&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(sleep\\\\((\\\\s*?)(\\\\d*?)(\\\\s*?)\\\\)|benchmark\\\\((.*?)\\\\,(.*?)\\\\)))\&quot; at ARGS:id.&quot; } } 일반적인 SQL Injection 공격으로 들어온 것이 감지 되었으며 추가로 blind sql 로 sleep() 혹은 benchmark() 를 사용한 공격이 감지 되었다는 것을 확인 할 수 있다." /><meta property="og:description" content="OWASP SQL Blind Injection 이전의 SQL Injection 공격은 SQL을 변경하여 원하는 데이터를 가져오게 하여 정보를 탈취하는 방법이다. 기존 공격 방법이 웹을 통하여 데이터베이스 메시지를 확인 할 수 있었다. 반면 메시지를 확인 할 수 없는 경우에는 Blind Injection 이라는 공격 방법을 통해 데이터를 탈취할 수 있다. 공격 방법은 SQL을 변경 하여 실행 하도록 하고 데이터 베이스 메시지 대신 서버로 부터 응답 결과 만을 보고 데이터를 탈취하는 방법 이다. 상자속에 든 물건을 알아보기 위해 손을 넣어서 만져보는 것처럼 보이지 않는 데이터를 알아보기 위해 다양한 공격을 하여 데이터를 탈취하는 것이다. 원하는 데이터를 탈취하기 위해 계속적으로 공격을 시도하여 결과를 비교하여 데이터를 탈취함으로 자동화 된 툴을 통해 공격이 이루어 진다. Blind SQL Injection - Boolean based SQL SQL 의 질의 결과가 참/거짓으로 하였을 때 서버의 반응으로 부터 데이터를 탈취하는 기술이다. 정상 요청의 경우 서버는 정상 반응을 하는 것을 확인 하고 변경된 질의를 하여 서버의 반응이 정상인지 아닌지를 보는 방법 이다. SQL injection과 유사하나 사용되는 SQL 의 패턴이 다르다. 원하는 데이터를 얻기 위해 하나씩 진행 하기 때문에 문자열 관련된 함수 (substr, limt 등)가 많이 사용 된다. Blind SQL Injection - Time based SQL SQL 의 결과를 볼 수 없을 때 사용 하는 공격 방법인 Blind SQL 의 패턴으로 시간을 이용하여 참/거짓을 구분 하는 공격 방법 이다. sleep 함수 등을 이용하여 데이터베이스의 종류 (mySQL의 경우 응답시간을 지연 시킬 수 있다)를 감지할 수 있고 해당 데이터베이스에 맞는 함수 IF, sleep 등을 이용하여 그 결과를 참인 경우 일정 시간 지연 되도록 하여 데이터를 탈취할 수 있다. SQL Blind Injection Detect SQL Bind injection 공격을 감지 하기 위해서는 WAF Policies 의 protection rules 에서 Blind SQL injections, SQL injection using sleep() or benchmark() 를 선택 하여 Action 으로 detect 를 하여 줍니다. (기존에 SQL injection 을 감지하기 위해 Classic SQL Injection probings, Common SQL Injects를 선택 하였다 만약 선택하지 않았다면 2개도 detect 하여 준다) 변경된 내용은 아직 적용되어 있지 않음으로 publish All 버튼을 클릭 하여 적용 하여 줍니다. 적용이 시작되면 Updating 상태가 되고 전체 WAF 서버에 변경 된 정책을 적용하게 되어 약간의 시간이 소요 된다. SQL Blind Injection - boolean based Attack SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 공격을 위해서는 정상적인 응답이 오는 경우를 알고 있어야 한다. 알고 있는 정보로는 1이라는 사용자가 있는 것을 알고 있음으로 1을 입력 후 Submit 을 눌러 보자. 아래 그림 처럼 1 이라는 사용자가 존재 한다는 것을 알 수 있다. 거짓인 데이터에 대해서 웹페이지의 반응을 보기 위해 아래와 같이 입력 하고 실행 해 준다. &#39; or &#39;1&#39;=&#39;2&#39; 위 그림처럼 거짓일 때는 User ID is MISSING from the database 라는 메시지가 출력 되는 것을 알 수 있다. 아래 문장을 입력 후 실행 하여 서버의 반응 보면 &#39; union select 1 # &#39; union select 1,2 # ’ union select 1,2 # 를 입력 하였을 때 참인 것을 볼 수 있다 이를 통해 실행 되는 SQL 의 Select 항목이 2개임을 알 수가 있다. 다음으로 데이터베이스 이름을 알기 위해 다음을 순서대로 입력 하고 실행 해 보자. 1&#39; and length(database()) =1 1&#39; and length(database()) =2 1&#39; and length(database()) =3 1&#39; and length(database()) =4 length(database())=4 일때 결과가 참인 것을 볼 수 있을 것이다. 이로서 데이터 베이스 이름의 길이가 4 라는 것을 알았고 다음을 입력 하여 데이터 베이스 이름을 유추 할 수 있다. 1&#39; and substr(database(),1,1) = &#39;a&#39; 1&#39; and substr(database(),1,1) = &#39;b&#39; 1&#39; and substr(database(),1,1) = &#39;c&#39; 1&#39; and substr(database(),1,1) = &#39;d&#39; d 에서 참으로 나오는 것을 볼 수 있으며 이로서 데이터 베이스 이름의 길이는 4 이고 첫 글자라 d 라는 것을 알수 있다. 이와 같은 방법으로 알고자 하는 정보를 입력 하여 맞는지 아닌지를 계속적으로 체크하면 원하는 데이터를 탈취 할 수 있다. 이후에 테이블 명, 갯수를 확인 하고 이름, 컬럼 정보를 알아보는 SQL 을 수행하여 전체 정보를 탈취 하게 된다. WAF의 SQL Blind Injection - boolean based 감지 WAF Policies에서 Metrics 를 보면 Detect 된 요청의 건수를 보여주는 대시보드를 볼 수 있다. 분단위로 WAF가 감지한 내용을 볼 수 있다. 상세 내용을 보기 위해 Logs 를 클릭 하여 조회 조건 중 Action 에서 Detect 를 선택 하고 조회 한다. Detect 된 리스트를 볼 수 있으며 상세 각 라인별로 간략한 내용을 볼 수 있다. 접근을 시도한 지역과 User Agent 즉, 브라우저 정보를 볼 수 있다. 상세한 내용을 보기 위한 View JSON 을 클릭 한다. &quot;protectionRuleDetections&quot;: { &quot;950001&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:\\\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...\&quot; at ARGS:id.&quot; }, &quot;950007&quot;: { &quot;Message&quot;: &quot;Blind SQL Injection Attack. Matched Data: substr found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:\\\\b(?:(?:s(?:ys\\\\.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|object|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect\\\\b.{0,40}\\\\b(?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|object)s|ysql\\\\.(db|user))|c(?:onstraint ...\&quot; at ARGS:id.&quot; }, &quot;959073&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...\&quot; at ARGS:id.&quot; }, &quot;981242&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 1/2. Matched attack string: [1&#39; and substr(databse(),1,1) = &#39;d&#39; ] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?(x?or|div|like|between|and)\\\\s*?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]?\\\\d)|(?:\\\\\\\\x(?:23|27|3d))|(?:^.?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]$)|(?:(?:^[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98\\\\\\\\]*?(?:[\\\\ ...\&quot; at ARGS:id.&quot; }, &quot;981243&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 2/2. Matched attack string: [1&#39; and substr(databse(),1,1) = &#39;d&#39; ] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?\\\\*.+(?:x?or|div|like|between|and|id)\\\\W*?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\d)|(?:\\\\^[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98])|(?:^[\\\\w\\\\s\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98-]+(?&lt;=and\\\\s)(?&lt;=or|xor ...\&quot; at ARGS:id.&quot; } }, 메시지를 살펴 보면 SQL Injection Attack 이 발생 하였으며 감지된 패턴이 id 파라미터에 1’ and substr(databse(),1,1) = ‘d’ 이 들어간 것이 감지 된 것을 알 수 있다. 또한 Blind SQL Injection Attack 으로 substr 이 감지 된 것을 볼 수 있다. 공격이 발생 하였을 때 한개의 패턴 만이 발생 하는 것보다 다수의 패턴이 동시에 사용 될 수 있으며 이 중 감지 되는 내용이 보여 지고 메시지 번호 등을 통해 정확한 내용을 검색 해 볼 수 있다. 다시 웹애플리케이션으로 돌아가 View Source를 클릭 하면 다음과 같은 코드로 작성되어 있음을 볼 수 있다. &lt;?php if( isset( $_GET[ &#39;Submit&#39; ] ) ) { // Get input $id = $_GET[ &#39;id&#39; ]; // Check database $getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;$id&#39;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $getid ); // Removed &#39;or die&#39; to suppress mysql errors // Get results $num = @mysqli_num_rows( $result ); // The &#39;@&#39; character suppresses errors if( $num &gt; 0 ) { // Feedback for end user echo &#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;; } else { // User wasn&#39;t found, so the page wasn&#39;t! header( $_SERVER[ &#39;SERVER_PROTOCOL&#39; ] . &#39; 404 Not Found&#39; ); // Feedback for end user echo &#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } ?&gt; SQL 실행이 $id 로 직접 웹페이지의 Query 파라미터를 받아 sql 문자열을 만든 후에 실행되며 실행 결과는 선택되는 레코드의 존재에 여부에 따라 메시지가 보여지는 것을 알 수 있다. 레코드가 있다 없다라는 정보를 통해 원하는 정보를 탈 취 할 수 있는 취약한 코드가 되는 것이다. 취약성점을 방지 하기 위해 코드를 수정 하거나 WAF 에서 감지 하여 공격자 정보를 파악 하고 Block 하는 조취를 하는 것이 필요하다 Blind SQL Injection - Time based SQL Attack SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 해당 페이지는 조회 결과의 유무에 따라 보여지는 메시지가 달라 boolean 을 이용한 공격이 가능하지만 시간을 이용한 공격을 위해 메시지를 볼 수 없는 것으로 가정 한다. 우선 다음과 같이 입력하여 1’ and sleep(15) # 한 후 Submit 을 클릭 하여 보면 응답 시간이 느리게 오는 것을 알 수 있다. 이를 통해 웹 애플리케이션이 사용하는 데이터베이스가 mySQL 인것을 알 수 있다. 데이터 베이스 명을 알아 보기 위해 다음을 입력 하여 실행 하여 보자. 위 그림처럼 거짓일 때는 User ID is MISSING from the database 라는 메시지가 출력 되는 것을 알 수 있다. 1&#39; and IF (length(database()) =1, sleep(15),0) # 1&#39; and IF (length(database()) =2, sleep(15),0) # 1&#39; and IF (length(database()) =3, sleep(15),0) # 1&#39; and IF (length(database()) =4, sleep(15),0) # 응답 시간이 1’ and IF (length(database()) =4, sleep(15),0) # 일 때 느려지는 것을 확인 할 수 있다. 이를 통해 데이터 베이스 이름의 길이가 4라는 것을 알 수 있다. WAF의 SQL Blind Injection - Time based 감지 WAF 의 Metric 에서 detect 항목이 추가된 것을 확인 할 수 있으며 Logs 에서 메시지를 확인 하여 보면 다른 Detect 항목과 동일 하게 클라이언트 정보 (지역, 브라우저)를 볼 수 있다. 자세한 정보를 보기 위해 View JSON 을 클릭 하여 보면 다음 메시지를 확인 할 수 있다. &quot;protectionRuleDetections&quot;: { &quot;950001&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1&#39; and IF (length(database()) =4, sleep(15),0) #&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:\\\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...\&quot; at ARGS:id.&quot; }, &quot;959073&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1&#39; and IF (length(database()) =4, sleep(15),0) #&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...\&quot; at ARGS:id.&quot; }, &quot;981243&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 2/2. Matched attack string: [1&#39; and IF (length(database()) =4, sleep(15),0) #] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(?:[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?\\\\*.+(?:x?or|div|like|between|and|id)\\\\W*?[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\d)|(?:\\\\^[\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98])|(?:^[\\\\w\\\\s\\\&quot;&#39;`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98-]+(?&lt;=and\\\\s)(?&lt;=or|xor ...\&quot; at ARGS:id.&quot; }, &quot;981272&quot;: { &quot;Message&quot;: &quot;Detects blind sqli tests using sleep() or benchmark().&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \&quot;(?i:(sleep\\\\((\\\\s*?)(\\\\d*?)(\\\\s*?)\\\\)|benchmark\\\\((.*?)\\\\,(.*?)\\\\)))\&quot; at ARGS:id.&quot; } } 일반적인 SQL Injection 공격으로 들어온 것이 감지 되었으며 추가로 blind sql 로 sleep() 혹은 benchmark() 를 사용한 공격이 감지 되었다는 것을 확인 할 수 있다." /><link rel="canonical" href="http://localhost:4000/edge/waf/sqlinjection/WAF-SQLBlindInjection/" /><meta property="og:url" content="http://localhost:4000/edge/waf/sqlinjection/WAF-SQLBlindInjection/" /><meta property="og:site_name" content="Jake Kim" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-13T13:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="WAF SQL Blind Injection" /><meta name="twitter:site" content="@xers9" /><meta name="twitter:creator" content="@Jake Kim" /><meta name="google-site-verification" content="sCRGg28ReGiDdQ4JQ75b6RCTtmBD9J6QQwh1kpIMDAU" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Jake Kim"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/kyudong.kim.png"},"name":"Jake Kim"},"url":"http://localhost:4000/edge/waf/sqlinjection/WAF-SQLBlindInjection/","headline":"WAF SQL Blind Injection","dateModified":"2020-03-13T13:00:00+09:00","datePublished":"2020-03-13T13:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/edge/waf/sqlinjection/WAF-SQLBlindInjection/"},"description":"OWASP SQL Blind Injection 이전의 SQL Injection 공격은 SQL을 변경하여 원하는 데이터를 가져오게 하여 정보를 탈취하는 방법이다. 기존 공격 방법이 웹을 통하여 데이터베이스 메시지를 확인 할 수 있었다. 반면 메시지를 확인 할 수 없는 경우에는 Blind Injection 이라는 공격 방법을 통해 데이터를 탈취할 수 있다. 공격 방법은 SQL을 변경 하여 실행 하도록 하고 데이터 베이스 메시지 대신 서버로 부터 응답 결과 만을 보고 데이터를 탈취하는 방법 이다. 상자속에 든 물건을 알아보기 위해 손을 넣어서 만져보는 것처럼 보이지 않는 데이터를 알아보기 위해 다양한 공격을 하여 데이터를 탈취하는 것이다. 원하는 데이터를 탈취하기 위해 계속적으로 공격을 시도하여 결과를 비교하여 데이터를 탈취함으로 자동화 된 툴을 통해 공격이 이루어 진다. Blind SQL Injection - Boolean based SQL SQL 의 질의 결과가 참/거짓으로 하였을 때 서버의 반응으로 부터 데이터를 탈취하는 기술이다. 정상 요청의 경우 서버는 정상 반응을 하는 것을 확인 하고 변경된 질의를 하여 서버의 반응이 정상인지 아닌지를 보는 방법 이다. SQL injection과 유사하나 사용되는 SQL 의 패턴이 다르다. 원하는 데이터를 얻기 위해 하나씩 진행 하기 때문에 문자열 관련된 함수 (substr, limt 등)가 많이 사용 된다. Blind SQL Injection - Time based SQL SQL 의 결과를 볼 수 없을 때 사용 하는 공격 방법인 Blind SQL 의 패턴으로 시간을 이용하여 참/거짓을 구분 하는 공격 방법 이다. sleep 함수 등을 이용하여 데이터베이스의 종류 (mySQL의 경우 응답시간을 지연 시킬 수 있다)를 감지할 수 있고 해당 데이터베이스에 맞는 함수 IF, sleep 등을 이용하여 그 결과를 참인 경우 일정 시간 지연 되도록 하여 데이터를 탈취할 수 있다. SQL Blind Injection Detect SQL Bind injection 공격을 감지 하기 위해서는 WAF Policies 의 protection rules 에서 Blind SQL injections, SQL injection using sleep() or benchmark() 를 선택 하여 Action 으로 detect 를 하여 줍니다. (기존에 SQL injection 을 감지하기 위해 Classic SQL Injection probings, Common SQL Injects를 선택 하였다 만약 선택하지 않았다면 2개도 detect 하여 준다) 변경된 내용은 아직 적용되어 있지 않음으로 publish All 버튼을 클릭 하여 적용 하여 줍니다. 적용이 시작되면 Updating 상태가 되고 전체 WAF 서버에 변경 된 정책을 적용하게 되어 약간의 시간이 소요 된다. SQL Blind Injection - boolean based Attack SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 공격을 위해서는 정상적인 응답이 오는 경우를 알고 있어야 한다. 알고 있는 정보로는 1이라는 사용자가 있는 것을 알고 있음으로 1을 입력 후 Submit 을 눌러 보자. 아래 그림 처럼 1 이라는 사용자가 존재 한다는 것을 알 수 있다. 거짓인 데이터에 대해서 웹페이지의 반응을 보기 위해 아래와 같이 입력 하고 실행 해 준다. &#39; or &#39;1&#39;=&#39;2&#39; 위 그림처럼 거짓일 때는 User ID is MISSING from the database 라는 메시지가 출력 되는 것을 알 수 있다. 아래 문장을 입력 후 실행 하여 서버의 반응 보면 &#39; union select 1 # &#39; union select 1,2 # ’ union select 1,2 # 를 입력 하였을 때 참인 것을 볼 수 있다 이를 통해 실행 되는 SQL 의 Select 항목이 2개임을 알 수가 있다. 다음으로 데이터베이스 이름을 알기 위해 다음을 순서대로 입력 하고 실행 해 보자. 1&#39; and length(database()) =1 1&#39; and length(database()) =2 1&#39; and length(database()) =3 1&#39; and length(database()) =4 length(database())=4 일때 결과가 참인 것을 볼 수 있을 것이다. 이로서 데이터 베이스 이름의 길이가 4 라는 것을 알았고 다음을 입력 하여 데이터 베이스 이름을 유추 할 수 있다. 1&#39; and substr(database(),1,1) = &#39;a&#39; 1&#39; and substr(database(),1,1) = &#39;b&#39; 1&#39; and substr(database(),1,1) = &#39;c&#39; 1&#39; and substr(database(),1,1) = &#39;d&#39; d 에서 참으로 나오는 것을 볼 수 있으며 이로서 데이터 베이스 이름의 길이는 4 이고 첫 글자라 d 라는 것을 알수 있다. 이와 같은 방법으로 알고자 하는 정보를 입력 하여 맞는지 아닌지를 계속적으로 체크하면 원하는 데이터를 탈취 할 수 있다. 이후에 테이블 명, 갯수를 확인 하고 이름, 컬럼 정보를 알아보는 SQL 을 수행하여 전체 정보를 탈취 하게 된다. WAF의 SQL Blind Injection - boolean based 감지 WAF Policies에서 Metrics 를 보면 Detect 된 요청의 건수를 보여주는 대시보드를 볼 수 있다. 분단위로 WAF가 감지한 내용을 볼 수 있다. 상세 내용을 보기 위해 Logs 를 클릭 하여 조회 조건 중 Action 에서 Detect 를 선택 하고 조회 한다. Detect 된 리스트를 볼 수 있으며 상세 각 라인별로 간략한 내용을 볼 수 있다. 접근을 시도한 지역과 User Agent 즉, 브라우저 정보를 볼 수 있다. 상세한 내용을 보기 위한 View JSON 을 클릭 한다. &quot;protectionRuleDetections&quot;: { &quot;950001&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:\\\\\\\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...\\&quot; at ARGS:id.&quot; }, &quot;950007&quot;: { &quot;Message&quot;: &quot;Blind SQL Injection Attack. Matched Data: substr found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(?:\\\\\\\\b(?:(?:s(?:ys\\\\\\\\.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|object|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect\\\\\\\\b.{0,40}\\\\\\\\b(?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|object)s|ysql\\\\\\\\.(db|user))|c(?:onstraint ...\\&quot; at ARGS:id.&quot; }, &quot;959073&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1&#39; and substr(databse(),1,1) = &#39;d&#39; &quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...\\&quot; at ARGS:id.&quot; }, &quot;981242&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 1/2. Matched attack string: [1&#39; and substr(databse(),1,1) = &#39;d&#39; ] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(?:[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]\\\\\\\\s*?(x?or|div|like|between|and)\\\\\\\\s*?[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]?\\\\\\\\d)|(?:\\\\\\\\\\\\\\\\x(?:23|27|3d))|(?:^.?[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]$)|(?:(?:^[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98\\\\\\\\\\\\\\\\]*?(?:[\\\\\\\\ ...\\&quot; at ARGS:id.&quot; }, &quot;981243&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 2/2. Matched attack string: [1&#39; and substr(databse(),1,1) = &#39;d&#39; ] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(?:[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]\\\\\\\\s*?\\\\\\\\*.+(?:x?or|div|like|between|and|id)\\\\\\\\W*?[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]\\\\\\\\d)|(?:\\\\\\\\^[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98])|(?:^[\\\\\\\\w\\\\\\\\s\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98-]+(?&lt;=and\\\\\\\\s)(?&lt;=or|xor ...\\&quot; at ARGS:id.&quot; } }, 메시지를 살펴 보면 SQL Injection Attack 이 발생 하였으며 감지된 패턴이 id 파라미터에 1’ and substr(databse(),1,1) = ‘d’ 이 들어간 것이 감지 된 것을 알 수 있다. 또한 Blind SQL Injection Attack 으로 substr 이 감지 된 것을 볼 수 있다. 공격이 발생 하였을 때 한개의 패턴 만이 발생 하는 것보다 다수의 패턴이 동시에 사용 될 수 있으며 이 중 감지 되는 내용이 보여 지고 메시지 번호 등을 통해 정확한 내용을 검색 해 볼 수 있다. 다시 웹애플리케이션으로 돌아가 View Source를 클릭 하면 다음과 같은 코드로 작성되어 있음을 볼 수 있다. &lt;?php if( isset( $_GET[ &#39;Submit&#39; ] ) ) { // Get input $id = $_GET[ &#39;id&#39; ]; // Check database $getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;$id&#39;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $getid ); // Removed &#39;or die&#39; to suppress mysql errors // Get results $num = @mysqli_num_rows( $result ); // The &#39;@&#39; character suppresses errors if( $num &gt; 0 ) { // Feedback for end user echo &#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;; } else { // User wasn&#39;t found, so the page wasn&#39;t! header( $_SERVER[ &#39;SERVER_PROTOCOL&#39; ] . &#39; 404 Not Found&#39; ); // Feedback for end user echo &#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;; } ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); } ?&gt; SQL 실행이 $id 로 직접 웹페이지의 Query 파라미터를 받아 sql 문자열을 만든 후에 실행되며 실행 결과는 선택되는 레코드의 존재에 여부에 따라 메시지가 보여지는 것을 알 수 있다. 레코드가 있다 없다라는 정보를 통해 원하는 정보를 탈 취 할 수 있는 취약한 코드가 되는 것이다. 취약성점을 방지 하기 위해 코드를 수정 하거나 WAF 에서 감지 하여 공격자 정보를 파악 하고 Block 하는 조취를 하는 것이 필요하다 Blind SQL Injection - Time based SQL Attack SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 해당 페이지는 조회 결과의 유무에 따라 보여지는 메시지가 달라 boolean 을 이용한 공격이 가능하지만 시간을 이용한 공격을 위해 메시지를 볼 수 없는 것으로 가정 한다. 우선 다음과 같이 입력하여 1’ and sleep(15) # 한 후 Submit 을 클릭 하여 보면 응답 시간이 느리게 오는 것을 알 수 있다. 이를 통해 웹 애플리케이션이 사용하는 데이터베이스가 mySQL 인것을 알 수 있다. 데이터 베이스 명을 알아 보기 위해 다음을 입력 하여 실행 하여 보자. 위 그림처럼 거짓일 때는 User ID is MISSING from the database 라는 메시지가 출력 되는 것을 알 수 있다. 1&#39; and IF (length(database()) =1, sleep(15),0) # 1&#39; and IF (length(database()) =2, sleep(15),0) # 1&#39; and IF (length(database()) =3, sleep(15),0) # 1&#39; and IF (length(database()) =4, sleep(15),0) # 응답 시간이 1’ and IF (length(database()) =4, sleep(15),0) # 일 때 느려지는 것을 확인 할 수 있다. 이를 통해 데이터 베이스 이름의 길이가 4라는 것을 알 수 있다. WAF의 SQL Blind Injection - Time based 감지 WAF 의 Metric 에서 detect 항목이 추가된 것을 확인 할 수 있으며 Logs 에서 메시지를 확인 하여 보면 다른 Detect 항목과 동일 하게 클라이언트 정보 (지역, 브라우저)를 볼 수 있다. 자세한 정보를 보기 위해 View JSON 을 클릭 하여 보면 다음 메시지를 확인 할 수 있다. &quot;protectionRuleDetections&quot;: { &quot;950001&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1&#39; and IF (length(database()) =4, sleep(15),0) #&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:\\\\\\\\b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...\\&quot; at ARGS:id.&quot; }, &quot;959073&quot;: { &quot;Message&quot;: &quot;SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1&#39; and IF (length(database()) =4, sleep(15),0) #&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...\\&quot; at ARGS:id.&quot; }, &quot;981243&quot;: { &quot;Message&quot;: &quot;Detects classic SQL injection probings 2/2. Matched attack string: [1&#39; and IF (length(database()) =4, sleep(15),0) #] in [ARGS:id];&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(?:[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]\\\\\\\\s*?\\\\\\\\*.+(?:x?or|div|like|between|and|id)\\\\\\\\W*?[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98]\\\\\\\\d)|(?:\\\\\\\\^[\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98])|(?:^[\\\\\\\\w\\\\\\\\s\\\\\\&quot;&#39;`\\\\xc2\\\\xb4\\\\xe2\\\\x80\\\\x99\\\\xe2\\\\x80\\\\x98-]+(?&lt;=and\\\\\\\\s)(?&lt;=or|xor ...\\&quot; at ARGS:id.&quot; }, &quot;981272&quot;: { &quot;Message&quot;: &quot;Detects blind sqli tests using sleep() or benchmark().&quot;, &quot;Message details&quot;: &quot;Warning. Pattern match \\&quot;(?i:(sleep\\\\\\\\((\\\\\\\\s*?)(\\\\\\\\d*?)(\\\\\\\\s*?)\\\\\\\\)|benchmark\\\\\\\\((.*?)\\\\\\\\,(.*?)\\\\\\\\)))\\&quot; at ARGS:id.&quot; } } 일반적인 SQL Injection 공격으로 들어온 것이 감지 되었으며 추가로 blind sql 로 sleep() 혹은 benchmark() 를 사용한 공격이 감지 되었다는 것을 확인 할 수 있다.","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --><title>WAF SQL Blind Injection</title><link rel="icon" type="image/png" href="?s=16" sizes="16x16"><link rel="icon" type="image/png" href="?s=32" sizes="32x32"><link rel="icon" type="image/png" href="?s=96" sizes="96x96"><link rel="shortcut icon" href=""><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Jake Kim" /></head><body> <svg xmlns="http://www.w3.org/2000/svg" style="height: 0; position: absolute" xmlns:xlink="http://www.w3.org/1999/xlink"> <symbol id="flickr" viewbox="0 0 16 16"><path d="M0 8c0 2.05 1.662 3.71 3.71 3.71 2.05 0 3.713-1.66 3.713-3.71S5.76 4.29 3.71 4.29C1.663 4.29 0 5.95 0 8zm8.577 0c0 2.05 1.662 3.71 3.712 3.71C14.337 11.71 16 10.05 16 8s-1.662-3.71-3.71-3.71c-2.05 0-3.713 1.66-3.713 3.71z"></path></symbol> <symbol id="github" viewbox="0 0 16 16"><path d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.083-.202-.358-1.015.077-2.117 0 0 .672-.215 2.2.82.638-.178 1.323-.266 2.003-.27.68.004 1.364.092 2.003.27 1.527-1.035 2.198-.82 2.198-.82.437 1.102.163 1.915.08 2.117.513.56.823 1.274.823 2.147 0 3.073-1.87 3.75-3.653 3.947.287.246.543.735.543 1.48 0 1.07-.01 1.933-.01 2.195 0 .215.144.463.55.385C13.71 14.53 16 11.534 16 8c0-4.418-3.582-8-8-8"></path></symbol> <symbol id="linkedin" viewbox="0 0 16 16"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"></path></symbol> <symbol id="rss" viewbox="0 0 16 16"><path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194 11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.985 2.194-2.196 2.194C.984 16 0 15.017 0 13.806c0-1.21.983-2.195 2.194-2.195zM10.606 16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"></path></symbol> <symbol id="twitter" viewbox="0 0 16 16"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.036-2.396-1.036-1.812 0-3.282 1.468-3.282 3.28 0 .258.03.51.085.75C5.152 5.39 2.733 4.084 1.114 2.1.83 2.583.67 3.147.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.416-.02-.617-.058.418 1.304 1.63 2.253 3.067 2.28-1.124.88-2.54 1.404-4.077 1.404-.265 0-.526-.015-.783-.045 1.453.93 3.178 1.474 5.032 1.474 6.038 0 9.34-5 9.34-9.338 0-.143-.004-.284-.01-.425.64-.463 1.198-1.04 1.638-1.7z" fill-rule="nonzero"></path></symbol> <symbol id="email" viewbox="0 0 16 11"><path fill-rule="evenodd" d="M1.33 0h13.34L8 5 1.33 0zM16 0v11H0V0l8 6 8-6z"></path></symbol> </svg><header class="header"><div class="container"> <a class="logo" href="http://localhost:4000" title="Jake Kim"><img src="/assets/img/kyudong.kim.png" alt="Jake Kim logo"></a><nav class="nav nav--header"><ul class="list list--nav">
<li class="item item--nav"><a href="/">Home</a></li>
<li class="item item--nav"><a href="/blog/">Blog</a></li>
</ul></nav>
</div></header><!--collect all blog tags http://longqian.me/2017/02/09/github-jekyll-tag/ --><main class="main container"><article class="content typeset"><h1>WAF SQL Blind Injection</h1>
<small class="small post-meta"> <span class="label label--category"> </span> <time datetime="2020-03-13T13:00:00+09:00" class="time"> 13 Mar 2020 </time> </small><div style="padding-bottom: 3%">
<h1 id="owasp-sql-blind-injection">OWASP SQL Blind Injection</h1>
<p>이전의 SQL Injection 공격은 SQL을 변경하여 원하는 데이터를 가져오게 하여 정보를 탈취하는 방법이다. 기존 공격 방법이 웹을 통하여 데이터베이스 메시지를 확인 할 수 있었다. 반면 메시지를 확인 할 수 없는 경우에는 Blind Injection 이라는 공격 방법을 통해 데이터를 탈취할 수 있다. 공격 방법은 SQL을 변경 하여 실행 하도록 하고 데이터 베이스 메시지 대신 서버로 부터 응답 결과 만을 보고 데이터를 탈취하는 방법 이다. 상자속에 든 물건을 알아보기 위해 손을 넣어서 만져보는 것처럼 보이지 않는 데이터를 알아보기 위해 다양한 공격을 하여 데이터를 탈취하는 것이다. 원하는 데이터를 탈취하기 위해 계속적으로 공격을 시도하여 결과를 비교하여 데이터를 탈취함으로 자동화 된 툴을 통해 공격이 이루어 진다.</p>
<h4 id="blind-sql-injection---boolean-based-sql">Blind SQL Injection - Boolean based SQL</h4>
<p>SQL 의 질의 결과가 참/거짓으로 하였을 때 서버의 반응으로 부터 데이터를 탈취하는 기술이다. 정상 요청의 경우 서버는 정상 반응을 하는 것을 확인 하고 변경된 질의를 하여 서버의 반응이 정상인지 아닌지를 보는 방법 이다. SQL injection과 유사하나 사용되는 SQL 의 패턴이 다르다. 원하는 데이터를 얻기 위해 하나씩 진행 하기 때문에 문자열 관련된 함수 (substr, limt 등)가 많이 사용 된다.</p>
<h4 id="blind-sql-injection---time-based-sql">Blind SQL Injection - Time based SQL</h4>
<p>SQL 의 결과를 볼 수 없을 때 사용 하는 공격 방법인 Blind SQL 의 패턴으로 시간을 이용하여 참/거짓을 구분 하는 공격 방법 이다. sleep 함수 등을 이용하여 데이터베이스의 종류 (mySQL의 경우 응답시간을 지연 시킬 수 있다)를 감지할 수 있고 해당 데이터베이스에 맞는 함수 IF, sleep 등을 이용하여 그 결과를 참인 경우 일정 시간 지연 되도록 하여 데이터를 탈취할 수 있다.</p>
<h1 id="sql-blind-injection-detect">SQL Blind Injection Detect</h1>
<p>SQL Bind injection 공격을 감지 하기 위해서는 WAF Policies 의 protection rules 에서 Blind SQL injections, SQL injection using sleep() or benchmark() 를 선택 하여 Action 으로 detect 를 하여 줍니다. (기존에 SQL injection 을 감지하기 위해 Classic SQL Injection probings, Common SQL Injects를 선택 하였다 만약 선택하지 않았다면 2개도 detect 하여 준다)</p>
<p><img src="/image/waf-sqlblind/waf-01.png" alt=""></p>
<p>변경된 내용은 아직 적용되어 있지 않음으로 publish All 버튼을 클릭 하여 적용 하여 줍니다. 적용이 시작되면 Updating 상태가 되고 전체 WAF 서버에 변경 된 정책을 적용하게 되어 약간의 시간이 소요 된다.</p>
<p><img src="/image/waf-sqlblind/waf-02.png" alt=""></p>
<h1 id="sql-blind-injection---boolean-based-attack">SQL Blind Injection - boolean based Attack</h1>
<p>SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 공격을 위해서는 정상적인 응답이 오는 경우를 알고 있어야 한다. 알고 있는 정보로는 1이라는 사용자가 있는 것을 알고 있음으로 1을 입력 후 Submit 을 눌러 보자. 아래 그림 처럼 1 이라는 사용자가 존재 한다는 것을 알 수 있다.</p>
<p><img src="/image/waf-sqlblind/waf-03.png" alt=""></p>
<p>거짓인 데이터에 대해서 웹페이지의 반응을 보기 위해 아래와 같이 입력 하고 실행 해 준다.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">' or '</span>1<span class="s1">'='</span>2<span class="s1">'    
</span></code></pre></div></div>
<p><img src="/image/waf-sqlblind/waf-04.png" alt=""></p>
<p>위 그림처럼 거짓일 때는 <strong><em>User ID is MISSING from the database</em></strong> 라는 메시지가 출력 되는 것을 알 수 있다.</p>
<p>아래 문장을 입력 후 실행 하여 서버의 반응 보면</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">' union select 1 #
'</span> union <span class="k">select </span>1,2  <span class="c">#</span>
</code></pre></div></div>
<p>’ union select 1,2 # 를 입력 하였을 때 참인 것을 볼 수 있다 이를 통해 실행 되는 SQL 의 Select 항목이 2개임을 알 수가 있다.</p>
<p>다음으로 데이터베이스 이름을 알기 위해 다음을 순서대로 입력 하고 실행 해 보자.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="s1">' and length(database()) =1 
1'</span> and length<span class="o">(</span>database<span class="o">())</span> <span class="o">=</span>2
1<span class="s1">' and length(database()) =3 
1'</span> and length<span class="o">(</span>database<span class="o">())</span> <span class="o">=</span>4 
</code></pre></div></div>
<p><strong><em>length(database())=4</em></strong> 일때 결과가 참인 것을 볼 수 있을 것이다. 이로서 데이터 베이스 이름의 길이가 4 라는 것을 알았고 다음을 입력 하여 데이터 베이스 이름을 유추 할 수 있다.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="s1">' and substr(database(),1,1) = '</span>a<span class="s1">' 
1'</span> and substr<span class="o">(</span>database<span class="o">()</span>,1,1<span class="o">)</span> <span class="o">=</span> <span class="s1">'b'</span> 
1<span class="s1">' and substr(database(),1,1) = '</span>c<span class="s1">' 
1'</span> and substr<span class="o">(</span>database<span class="o">()</span>,1,1<span class="o">)</span> <span class="o">=</span> <span class="s1">'d'</span> 
</code></pre></div></div>
<p><img src="/image/waf-sqlblind/waf-05.png" alt=""></p>
<p>d 에서 참으로 나오는 것을 볼 수 있으며 이로서 데이터 베이스 이름의 길이는 4 이고 첫 글자라 d 라는 것을 알수 있다. 이와 같은 방법으로 알고자 하는 정보를 입력 하여 맞는지 아닌지를 계속적으로 체크하면 원하는 데이터를 탈취 할 수 있다. 이후에 테이블 명, 갯수를 확인 하고 이름, 컬럼 정보를 알아보는 SQL 을 수행하여 전체 정보를 탈취 하게 된다.</p>
<h4 id="waf의-sql-blind-injection---boolean-based-감지">WAF의 SQL Blind Injection - boolean based 감지</h4>
<p>WAF Policies에서 Metrics 를 보면 Detect 된 요청의 건수를 보여주는 대시보드를 볼 수 있다. 분단위로 WAF가 감지한 내용을 볼 수 있다.</p>
<p><img src="/image/waf-sqlblind/waf-06.png" alt=""></p>
<p>상세 내용을 보기 위해 Logs 를 클릭 하여 조회 조건 중 Action 에서 Detect 를 선택 하고 조회 한다. Detect 된 리스트를 볼 수 있으며 상세 각 라인별로 간략한 내용을 볼 수 있다.</p>
<p><img src="/image/waf-sqlblind/waf-07.png" alt=""></p>
<p>접근을 시도한 지역과 User Agent 즉, 브라우저 정보를 볼 수 있다. 상세한 내용을 보기 위한 View JSON 을 클릭 한다.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"protectionRuleDetections"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"950001"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1' and substr(databse(),1,1) = 'd' "</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:</span><span class="se">\\\\</span><span class="s2">b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"950007"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Blind SQL Injection Attack. Matched Data: substr found within ARGS:id: 1' and substr(databse(),1,1) = 'd' "</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(?:</span><span class="se">\\\\</span><span class="s2">b(?:(?:s(?:ys</span><span class="se">\\\\</span><span class="s2">.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|object|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect</span><span class="se">\\\\</span><span class="s2">b.{0,40}</span><span class="se">\\\\</span><span class="s2">b(?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|object)s|ysql</span><span class="se">\\\\</span><span class="s2">.(db|user))|c(?:onstraint ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"959073"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SQL Injection Attack. Matched Data: substr( found within ARGS:id: 1' and substr(databse(),1,1) = 'd' "</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"981242"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Detects classic SQL injection probings 1/2. Matched attack string: [1' and substr(databse(),1,1) = 'd' ] in [ARGS:id];"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(?:[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]</span><span class="se">\\\\</span><span class="s2">s*?(x?or|div|like|between|and)</span><span class="se">\\\\</span><span class="s2">s*?[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]?</span><span class="se">\\\\</span><span class="s2">d)|(?:</span><span class="se">\\\\\\\\</span><span class="s2">x(?:23|27|3d))|(?:^.?[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]$)|(?:(?:^[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98</span><span class="se">\\\\\\\\</span><span class="s2">]*?(?:[</span><span class="se">\\\\</span><span class="s2"> ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"981243"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Detects classic SQL injection probings 2/2. Matched attack string: [1' and substr(databse(),1,1) = 'd' ] in [ARGS:id];"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(?:[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]</span><span class="se">\\\\</span><span class="s2">s*?</span><span class="se">\\\\</span><span class="s2">*.+(?:x?or|div|like|between|and|id)</span><span class="se">\\\\</span><span class="s2">W*?[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]</span><span class="se">\\\\</span><span class="s2">d)|(?:</span><span class="se">\\\\</span><span class="s2">^[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98])|(?:^[</span><span class="se">\\\\</span><span class="s2">w</span><span class="se">\\\\</span><span class="s2">s</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98-]+(?&lt;=and</span><span class="se">\\\\</span><span class="s2">s)(?&lt;=or|xor ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="err">,</span><span class="w">  
</span></code></pre></div></div>
<p>메시지를 살펴 보면 SQL Injection Attack 이 발생 하였으며 감지된 패턴이 id 파라미터에 <strong><em>1’ and substr(databse(),1,1) = ‘d’</em></strong> 이 들어간 것이 감지 된 것을 알 수 있다. 또한 Blind SQL Injection Attack 으로 substr 이 감지 된 것을 볼 수 있다. 공격이 발생 하였을 때 한개의 패턴 만이 발생 하는 것보다 다수의 패턴이 동시에 사용 될 수 있으며 이 중 감지 되는 내용이 보여 지고 메시지 번호 등을 통해 정확한 내용을 검색 해 볼 수 있다.</p>
<p>다시 웹애플리케이션으로 돌아가 View Source를 클릭 하면 다음과 같은 코드로 작성되어 있음을 볼 수 있다.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="k">if</span><span class="p">(</span> <span class="nb">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="s1">'Submit'</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Get input</span>
    <span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="s1">'id'</span> <span class="p">];</span>

    <span class="c1">// Check database</span>
    <span class="nv">$getid</span>  <span class="o">=</span> <span class="s2">"SELECT first_name, last_name FROM users WHERE user_id = '</span><span class="nv">$id</span><span class="s2">';"</span><span class="p">;</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">"___mysqli_ston"</span><span class="p">],</span>  <span class="nv">$getid</span> <span class="p">);</span> <span class="c1">// Removed 'or die' to suppress mysql errors</span>

    <span class="c1">// Get results</span>
    <span class="nv">$num</span> <span class="o">=</span> <span class="o">@</span><span class="nx">mysqli_num_rows</span><span class="p">(</span> <span class="nv">$result</span> <span class="p">);</span> <span class="c1">// The '@' character suppresses errors</span>
    <span class="k">if</span><span class="p">(</span> <span class="nv">$num</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Feedback for end user</span>
        <span class="k">echo</span> <span class="s1">'&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// User wasn't found, so the page wasn't!</span>
        <span class="nb">header</span><span class="p">(</span> <span class="nv">$_SERVER</span><span class="p">[</span> <span class="s1">'SERVER_PROTOCOL'</span> <span class="p">]</span> <span class="o">.</span> <span class="s1">' 404 Not Found'</span> <span class="p">);</span>

        <span class="c1">// Feedback for end user</span>
        <span class="k">echo</span> <span class="s1">'&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="p">((</span><span class="nb">is_null</span><span class="p">(</span><span class="nv">$___mysqli_res</span> <span class="o">=</span> <span class="nx">mysqli_close</span><span class="p">(</span><span class="nv">$GLOBALS</span><span class="p">[</span><span class="s2">"___mysqli_ston"</span><span class="p">])))</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="nv">$___mysqli_res</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">?&gt;</span> 
</code></pre></div></div>
<p>SQL 실행이 $id 로 직접 웹페이지의 Query 파라미터를 받아 sql 문자열을 만든 후에 실행되며 실행 결과는 선택되는 레코드의 존재에 여부에 따라 메시지가 보여지는 것을 알 수 있다. 레코드가 있다 없다라는 정보를 통해 원하는 정보를 탈 취 할 수 있는 취약한 코드가 되는 것이다. 취약성점을 방지 하기 위해 코드를 수정 하거나 WAF 에서 감지 하여 공격자 정보를 파악 하고 Block 하는 조취를 하는 것이 필요하다</p>
<h1 id="blind-sql-injection---time-based-sql-attack">Blind SQL Injection - Time based SQL Attack</h1>
<p>SQL Injection 공격을 위해 웹애플리케이션에 로그인 한다. http://waf.korwaf.site/ 에 로그인 하면 메뉴 중 SQL Injection (blind)을 클릭 한다. 해당 페이지는 조회 결과의 유무에 따라 보여지는 메시지가 달라 boolean 을 이용한 공격이 가능하지만 시간을 이용한 공격을 위해 메시지를 볼 수 없는 것으로 가정 한다.</p>
<p>우선 다음과 같이 입력하여 <strong><em>1’ and sleep(15) #</em></strong> 한 후 Submit 을 클릭 하여 보면 응답 시간이 느리게 오는 것을 알 수 있다. 이를 통해 웹 애플리케이션이 사용하는 데이터베이스가 mySQL 인것을 알 수 있다. 데이터 베이스 명을 알아 보기 위해 다음을 입력 하여 실행 하여 보자.</p>
<p><img src="/image/waf-sqlblind/waf-04.png" alt=""></p>
<p>위 그림처럼 거짓일 때는 <strong><em>User ID is MISSING from the database</em></strong> 라는 메시지가 출력 되는 것을 알 수 있다.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="s1">' and IF (length(database()) =1, sleep(15),0) # 
1'</span> and IF <span class="o">(</span>length<span class="o">(</span>database<span class="o">())</span> <span class="o">=</span>2, <span class="nb">sleep</span><span class="o">(</span>15<span class="o">)</span>,0<span class="o">)</span> <span class="c"># </span>
1<span class="s1">' and IF (length(database()) =3, sleep(15),0) # 
1'</span> and IF <span class="o">(</span>length<span class="o">(</span>database<span class="o">())</span> <span class="o">=</span>4, <span class="nb">sleep</span><span class="o">(</span>15<span class="o">)</span>,0<span class="o">)</span> <span class="c"># </span>
</code></pre></div></div>
<p>응답 시간이 <strong><em>1’ and IF (length(database()) =4, sleep(15),0) #</em></strong> 일 때 느려지는 것을 확인 할 수 있다. 이를 통해 데이터 베이스 이름의 길이가 4라는 것을 알 수 있다.</p>
<p><img src="/image/waf-sqlblind/waf-08.png" alt=""></p>
<h4 id="waf의-sql-blind-injection---time-based-감지">WAF의 SQL Blind Injection - Time based 감지</h4>
<p>WAF 의 Metric 에서 detect 항목이 추가된 것을 확인 할 수 있으며 Logs 에서 메시지를 확인 하여 보면 다른 Detect 항목과 동일 하게 클라이언트 정보 (지역, 브라우저)를 볼 수 있다. 자세한 정보를 보기 위해 View JSON 을 클릭 하여 보면 다음 메시지를 확인 할 수 있다.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"protectionRuleDetections"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"950001"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1' and IF (length(database()) =4, sleep(15),0) #"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:</span><span class="se">\\\\</span><span class="s2">b(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4| ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"959073"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SQL Injection Attack. Matched Data: IF ( found within ARGS:id: 1' and IF (length(database()) =4, sleep(15),0) #"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"981243"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Detects classic SQL injection probings 2/2. Matched attack string: [1' and IF (length(database()) =4, sleep(15),0) #] in [ARGS:id];"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(?:[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]</span><span class="se">\\\\</span><span class="s2">s*?</span><span class="se">\\\\</span><span class="s2">*.+(?:x?or|div|like|between|and|id)</span><span class="se">\\\\</span><span class="s2">W*?[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98]</span><span class="se">\\\\</span><span class="s2">d)|(?:</span><span class="se">\\\\</span><span class="s2">^[</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98])|(?:^[</span><span class="se">\\\\</span><span class="s2">w</span><span class="se">\\\\</span><span class="s2">s</span><span class="se">\\\"</span><span class="s2">'`</span><span class="se">\\</span><span class="s2">xc2</span><span class="se">\\</span><span class="s2">xb4</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x99</span><span class="se">\\</span><span class="s2">xe2</span><span class="se">\\</span><span class="s2">x80</span><span class="se">\\</span><span class="s2">x98-]+(?&lt;=and</span><span class="se">\\\\</span><span class="s2">s)(?&lt;=or|xor ...</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"981272"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Detects blind sqli tests using sleep() or benchmark()."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Message details"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning. Pattern match </span><span class="se">\"</span><span class="s2">(?i:(sleep</span><span class="se">\\\\</span><span class="s2">((</span><span class="se">\\\\</span><span class="s2">s*?)(</span><span class="se">\\\\</span><span class="s2">d*?)(</span><span class="se">\\\\</span><span class="s2">s*?)</span><span class="se">\\\\</span><span class="s2">)|benchmark</span><span class="se">\\\\</span><span class="s2">((.*?)</span><span class="se">\\\\</span><span class="s2">,(.*?)</span><span class="se">\\\\</span><span class="s2">)))</span><span class="se">\"</span><span class="s2"> at ARGS:id."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>일반적인 SQL Injection 공격으로 들어온 것이 감지 되었으며 추가로 blind sql 로 sleep() 혹은 benchmark() 를 사용한 공격이 감지 되었다는 것을 확인 할 수 있다.</p>
</div></article><aside class="aside typeset"><h4>Related Posts</h4>
<ul class="list list--posts">
<li class="item item--post"><div class="typeset">
<h4><a href="/edge/waf/sqlinjection/WAF-SQLInjection/">WAF SQL Injection</a></h4>
<small class="small post-meta"> <time datetime="2020-03-12T00:50:00+09:00" class="time"> 12 Mar 2020 </time> </small> <span><br><h1 id="owasp-sql-injection">OWASP SQL Injection</h1>
<p>첫 번째로 WAF를 이용하여 SQL Injection...</p></span>
</div></li>
<li class="item item--post"><div class="typeset">
<h4><a href="/edge/waf/WAF-register/">WAF 등록</a></h4>
<small class="small post-meta"> <time datetime="2020-03-08T19:46:00+09:00" class="time"> 08 Mar 2020 </time> </small> <span><br><h1 id="web-application-firewall">Web Application firewall</h1>
<p>웹애플리케이션 방화벽(이하 WAF)은 기존 방화벽이 네트워크의...</p></span>
</div></li>
<li class="item item--post"><div class="typeset">
<h4><a href="/oke/container/respository/OCIR-basic/">Container Repository</a></h4>
<small class="small post-meta"> <time datetime="2020-03-06T16:57:53+09:00" class="time"> 06 Mar 2020 </time> </small> <span><br><h1 id="container-repository">Container Repository</h1>
<p>Oracle Kubernetes Engine는 Docker를 기반으로 하는 서비스로...</p></span>
</div></li>
</ul>
<a class="button" href="/feed.xml" title="Subscribe">Subscribe  <svg class="icon" role="img"><use xlink:href="#rss"></use></svg></a><nav class="nav nav--social"><h6>Contact me:</h6>
<a class="link" target="_blank" href="https://github.com/xers989" title="github"><svg class="icon" role="img"><use xlink:href="#github"></use></svg></a> <a class="link" target="_blank" href="https://www.linkedin.com/in/kyudong-kim-80778033/" title="linkedin"><svg class="icon" role="img"><use xlink:href="#linkedin"></use></svg></a></nav></aside></main><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-93479534-1', 'auto'); ga('send', 'pageview'); </script><footer class="footer"><div class="container">
<nav class="nav nav--footer"><ul class="list list--nav"><li class="item item--nav"> <a href="https://alembic.darn.es/">Adopted Alembic Theme</a>
</li></ul></nav><div class="copyright typeset"> <small style="color:white;">© Jake Kim 2020</small>
</div>
</div></footer></body><link rel="stylesheet" href="/assets/styles.css"><link href="https://fonts.googleapis.com/css?family=Roboto:300" rel="stylesheet"></html>
