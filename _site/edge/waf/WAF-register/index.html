<!DOCTYPE html><html lang="en-GB"><head> <!-- General meta --><meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --><meta name="generator" content="Jekyll v3.8.5" /><meta property="og:title" content="WAF 등록" /><meta name="author" content="Jake Kim" /><meta property="og:locale" content="en_US" /><meta name="description" content="Web Application firewall 웹애플리케이션 방화벽(이하 WAF)은 기존 방화벽이 네트워크의 레이어 3,4 에서 동작하는 방화벽을 개선 한 것이다. 이름에서 예측 할 수 있듯이 레이어 7 방화벽으로 웹 트래픽 내부에 데이터까지 스캐닝 하여 악성 코드나 인젝션 공격 등을 사전에 방어 하는 서비스이다. 증가되고 있는 DDoS 공격 등을 감지하고 방어하여 도입이 늘어나는 추세라고 볼 수 있다. WAF는 크게 두 가지 형태로 구분해 볼 수 있는데 데이터 센터내에 설치 구현하는 방법과 클라우드에 설치 하는 방법으로 나눌 수가 있다. 데이터 센터내에 설치 하는 것은 인터넷을 거쳐 유입되는 트래픽을 웹서버로 전달 하기 전에 검사하는 것으로 검사 장비가 데이터 센터내에 설치 되는 것이다. 이 경우 DDoS 공격을 받게 되면 WAF 자체도 부하를 받게 되어 효과적인 방어가 어려울 수 있으며 늘어나는 공격방법에 대한 업데이트를 주기적으로 해주어야 하는 단점이 있다. 클라우드에 설치되는 WAF서비스를 클라우드에 배포 하고 처리 하는 것으로 클라우드 특성을 활용하여 DDoS 공격 등에 자원을 동적으로 증가 시켜 대응 하여 공격을 방어 한다. 또한 서비스 형태의 WAF는 증가되는 공격 방법을 주기적으로 업데이트 하여 주어 관리 측면에 장점이 있다. 오라클 WAF는 클라우드 기반의 방화벽 서비스로 사용한 만큼만 지불 하기 때문에 도입비용이 낮고 적용이 매우 간단하다는 장점이 있다." /><meta property="og:description" content="Web Application firewall 웹애플리케이션 방화벽(이하 WAF)은 기존 방화벽이 네트워크의 레이어 3,4 에서 동작하는 방화벽을 개선 한 것이다. 이름에서 예측 할 수 있듯이 레이어 7 방화벽으로 웹 트래픽 내부에 데이터까지 스캐닝 하여 악성 코드나 인젝션 공격 등을 사전에 방어 하는 서비스이다. 증가되고 있는 DDoS 공격 등을 감지하고 방어하여 도입이 늘어나는 추세라고 볼 수 있다. WAF는 크게 두 가지 형태로 구분해 볼 수 있는데 데이터 센터내에 설치 구현하는 방법과 클라우드에 설치 하는 방법으로 나눌 수가 있다. 데이터 센터내에 설치 하는 것은 인터넷을 거쳐 유입되는 트래픽을 웹서버로 전달 하기 전에 검사하는 것으로 검사 장비가 데이터 센터내에 설치 되는 것이다. 이 경우 DDoS 공격을 받게 되면 WAF 자체도 부하를 받게 되어 효과적인 방어가 어려울 수 있으며 늘어나는 공격방법에 대한 업데이트를 주기적으로 해주어야 하는 단점이 있다. 클라우드에 설치되는 WAF서비스를 클라우드에 배포 하고 처리 하는 것으로 클라우드 특성을 활용하여 DDoS 공격 등에 자원을 동적으로 증가 시켜 대응 하여 공격을 방어 한다. 또한 서비스 형태의 WAF는 증가되는 공격 방법을 주기적으로 업데이트 하여 주어 관리 측면에 장점이 있다. 오라클 WAF는 클라우드 기반의 방화벽 서비스로 사용한 만큼만 지불 하기 때문에 도입비용이 낮고 적용이 매우 간단하다는 장점이 있다." /><link rel="canonical" href="http://localhost:4000/edge/waf/WAF-register/" /><meta property="og:url" content="http://localhost:4000/edge/waf/WAF-register/" /><meta property="og:site_name" content="Jake Kim" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-08T19:46:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="WAF 등록" /><meta name="twitter:site" content="@xers9" /><meta name="twitter:creator" content="@Jake Kim" /><meta name="google-site-verification" content="sCRGg28ReGiDdQ4JQ75b6RCTtmBD9J6QQwh1kpIMDAU" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Jake Kim"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/kyudong.kim.png"},"name":"Jake Kim"},"url":"http://localhost:4000/edge/waf/WAF-register/","headline":"WAF 등록","dateModified":"2020-03-08T19:46:00+09:00","datePublished":"2020-03-08T19:46:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/edge/waf/WAF-register/"},"description":"Web Application firewall 웹애플리케이션 방화벽(이하 WAF)은 기존 방화벽이 네트워크의 레이어 3,4 에서 동작하는 방화벽을 개선 한 것이다. 이름에서 예측 할 수 있듯이 레이어 7 방화벽으로 웹 트래픽 내부에 데이터까지 스캐닝 하여 악성 코드나 인젝션 공격 등을 사전에 방어 하는 서비스이다. 증가되고 있는 DDoS 공격 등을 감지하고 방어하여 도입이 늘어나는 추세라고 볼 수 있다. WAF는 크게 두 가지 형태로 구분해 볼 수 있는데 데이터 센터내에 설치 구현하는 방법과 클라우드에 설치 하는 방법으로 나눌 수가 있다. 데이터 센터내에 설치 하는 것은 인터넷을 거쳐 유입되는 트래픽을 웹서버로 전달 하기 전에 검사하는 것으로 검사 장비가 데이터 센터내에 설치 되는 것이다. 이 경우 DDoS 공격을 받게 되면 WAF 자체도 부하를 받게 되어 효과적인 방어가 어려울 수 있으며 늘어나는 공격방법에 대한 업데이트를 주기적으로 해주어야 하는 단점이 있다. 클라우드에 설치되는 WAF서비스를 클라우드에 배포 하고 처리 하는 것으로 클라우드 특성을 활용하여 DDoS 공격 등에 자원을 동적으로 증가 시켜 대응 하여 공격을 방어 한다. 또한 서비스 형태의 WAF는 증가되는 공격 방법을 주기적으로 업데이트 하여 주어 관리 측면에 장점이 있다. 오라클 WAF는 클라우드 기반의 방화벽 서비스로 사용한 만큼만 지불 하기 때문에 도입비용이 낮고 적용이 매우 간단하다는 장점이 있다.","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --><title>WAF 등록</title><link rel="icon" type="image/png" href="?s=16" sizes="16x16"><link rel="icon" type="image/png" href="?s=32" sizes="32x32"><link rel="icon" type="image/png" href="?s=96" sizes="96x96"><link rel="shortcut icon" href=""><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Jake Kim" /></head><body> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="height: 0; position: absolute"> <symbol id="flickr" viewBox="0 0 16 16"><path d="M0 8c0 2.05 1.662 3.71 3.71 3.71 2.05 0 3.713-1.66 3.713-3.71S5.76 4.29 3.71 4.29C1.663 4.29 0 5.95 0 8zm8.577 0c0 2.05 1.662 3.71 3.712 3.71C14.337 11.71 16 10.05 16 8s-1.662-3.71-3.71-3.71c-2.05 0-3.713 1.66-3.713 3.71z"/></symbol> <symbol id="github" viewBox="0 0 16 16"><path d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.083-.202-.358-1.015.077-2.117 0 0 .672-.215 2.2.82.638-.178 1.323-.266 2.003-.27.68.004 1.364.092 2.003.27 1.527-1.035 2.198-.82 2.198-.82.437 1.102.163 1.915.08 2.117.513.56.823 1.274.823 2.147 0 3.073-1.87 3.75-3.653 3.947.287.246.543.735.543 1.48 0 1.07-.01 1.933-.01 2.195 0 .215.144.463.55.385C13.71 14.53 16 11.534 16 8c0-4.418-3.582-8-8-8"/></symbol> <symbol id="linkedin" viewBox="0 0 16 16"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></symbol> <symbol id="rss" viewBox="0 0 16 16"><path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194 11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.985 2.194-2.196 2.194C.984 16 0 15.017 0 13.806c0-1.21.983-2.195 2.194-2.195zM10.606 16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"/></symbol> <symbol id="twitter" viewBox="0 0 16 16"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.036-2.396-1.036-1.812 0-3.282 1.468-3.282 3.28 0 .258.03.51.085.75C5.152 5.39 2.733 4.084 1.114 2.1.83 2.583.67 3.147.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.416-.02-.617-.058.418 1.304 1.63 2.253 3.067 2.28-1.124.88-2.54 1.404-4.077 1.404-.265 0-.526-.015-.783-.045 1.453.93 3.178 1.474 5.032 1.474 6.038 0 9.34-5 9.34-9.338 0-.143-.004-.284-.01-.425.64-.463 1.198-1.04 1.638-1.7z" fill-rule="nonzero"/></symbol> <symbol id="email" viewBox="0 0 16 11"><path fill-rule="evenodd" d="M1.33 0h13.34L8 5 1.33 0zM16 0v11H0V0l8 6 8-6z"/></symbol> </svg><header class="header"><div class="container"> <a class="logo" href="http://localhost:4000" title="Jake Kim"><img src="/assets/img/kyudong.kim.png" alt="Jake Kim logo"/></a><nav class="nav nav--header"><ul class="list list--nav"><li class="item item--nav"><a href="/">Home</a></li><li class="item item--nav"><a href="/blog/">Blog</a></li></ul></nav></div></header><!--collect all blog tags http://longqian.me/2017/02/09/github-jekyll-tag/ --><main class="main container"><article class="content typeset"><h1>WAF 등록</h1><small class="small post-meta"> <span class="label label--category"> </span> <time datetime="2020-03-08T19:46:00+09:00" class="time"> 08 Mar 2020 </time> </small><div style="padding-bottom: 3%"><h1 id="web-application-firewall">Web Application firewall</h1><p>웹애플리케이션 방화벽(이하 WAF)은 기존 방화벽이 네트워크의 레이어 3,4 에서 동작하는 방화벽을 개선 한 것이다. 이름에서 예측 할 수 있듯이 레이어 7 방화벽으로 웹 트래픽 내부에 데이터까지 스캐닝 하여 악성 코드나 인젝션 공격 등을 사전에 방어 하는 서비스이다. 증가되고 있는 DDoS 공격 등을 감지하고 방어하여 도입이 늘어나는 추세라고 볼 수 있다. WAF는 크게 두 가지 형태로 구분해 볼 수 있는데 데이터 센터내에 설치 구현하는 방법과 클라우드에 설치 하는 방법으로 나눌 수가 있다. 데이터 센터내에 설치 하는 것은 인터넷을 거쳐 유입되는 트래픽을 웹서버로 전달 하기 전에 검사하는 것으로 검사 장비가 데이터 센터내에 설치 되는 것이다. 이 경우 DDoS 공격을 받게 되면 WAF 자체도 부하를 받게 되어 효과적인 방어가 어려울 수 있으며 늘어나는 공격방법에 대한 업데이트를 주기적으로 해주어야 하는 단점이 있다. 클라우드에 설치되는 WAF서비스를 클라우드에 배포 하고 처리 하는 것으로 클라우드 특성을 활용하여 DDoS 공격 등에 자원을 동적으로 증가 시켜 대응 하여 공격을 방어 한다. 또한 서비스 형태의 WAF는 증가되는 공격 방법을 주기적으로 업데이트 하여 주어 관리 측면에 장점이 있다. 오라클 WAF는 클라우드 기반의 방화벽 서비스로 사용한 만큼만 지불 하기 때문에 도입비용이 낮고 적용이 매우 간단하다는 장점이 있다. <br /> <img src="/image/waf-register/waf-01.png" alt="" /></p><p>그림과 같이 WAF 는 데이터 센터 혹은 애플리케이션이 설치된 네트워크 외부에 배치 되어 있어 애플리케이션에 영향을 영향을 주지 않는다. 동작은 Proxy서버 처럼 모든 트래픽을 앞단에서 처리 하는 역할을 한다. WAF를 거치도록 처리하는 것은 DNS를 이용하여 간단하게 처리 될 수 있으며 애플리케이션에 전혀 수정이 없이 빠르게 처리 될 수 있다. 방법은 DNS 제공자, 예를 들어 goDaddy,가 제공하는 도메인 주소를 WAF주소로 설정하고 WAF서비스가 이를 받아 처리하고 정상 트랙픽만을 웹애플리케이션(통산 Origin 이라고 한다)으로 전달 한다. 오라클 WAF는 Edge에서 제공하는 서비스로 오라클이 제공하는 모든 Edge에 설정한 WAF정보가 배포된다. 만약 유럽의 사용자가 웹애플리케이션을 접근 하는 경우 유럽에 설치된 Edge의 WAF에 트래픽이 전달 되어 처리 된다. 한국 사용자의 경우 한국에 설치된 Edge의 WAF에 트래픽이 전달된다. <br /> <img src="/image/waf-register/waf-02.png" alt="" /></p><p>그림 처럼 글로벌 하게 분포된 Edge가 사용자의 트래픽을 받고 그 중 정상 트래픽만을 웹애플리케이션(origin)으로 전달한다. DDoS를 포함한 외부 공격을 앞단에서 방어 하여 웹애플리케이션에 영향을 주지 않는 구조이다.</p><h1 id="waf-설정">WAF 설정</h1><p>WAF 설정을 위해서는 웹애플리케이션의 도메인명이 등록 되어 있어야 한다. DNS를 이용하여 WAF를 경유 하도록 하는 구조임으로 테스트등을 하기 위해서는 도메인을 보유 하고 있어야 한다. korwaf.site라는 도메인을 보유하고 있음으로 waf.korwaf.site 도메인을 생성하고 웹어플리에션을 생성하는 방법을 소개 하도록 하겠다. <br /> 전체 구조는 다음과 같다. <br /> <img src="/image/waf-register/waf-04.png" alt="" /> Origin에 Web Application을 구성 하고 WAF에 Origin을 등록 하여 주면 고유한 주소가 생성이 되며 이를 DNS에 등록 하여 주면 설정이 완료 된다. 사용자가 도메인 (waf.korwaf.site)을 접근 하려 할때 DNS는 WAF의 주소를 반환하게 되며 WAF는 사용자 트래픽을 설정된 Origin으로 전달하는 구조이다.</p><h4 id="web-application-설치">Web application 설치</h4><p>애플리케이션의 취약점을 테스트 하기 위한 웹애플리케이션을 설치하도록 한다. 취약점을 테스트하기 위한 Docker image DVWA를 사용하도록 한다. (https://hub.docker.com/r/vulnerables/web-dvwa) <br /> 공용 IP를 가지고 있는 인스턴스를 생성 한 후에 Docker engine을 설치 한다. 로컬 환경에 머신과 공용 IP가 있다면 로컬에 구성 하여도 상관없으나 빠르게 환경을 구성하기 위해서는 클라우드 환경을 추천 한다. Linux 환경을 기준으로 Docker engine 설치와 docker image 를 구동 하는 것 명령어 이다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@wafapplication]# yum <span class="nb">install </span>docker-engine <span class="nt">-y</span>  

<span class="o">====================================================================================================================================================</span>
 Package                             Arch                     Version                                            Repository                    Size
<span class="o">====================================================================================================================================================</span>
Installing:
 docker-engine                       x86_64                   19.03.1.ol-1.0.0.el7                               ol7_addons                    24 M
Installing <span class="k">for </span>dependencies:
 container-selinux                   noarch                   2:2.77-5.el7                                       ol7_addons                    37 k
 containerd                          x86_64                   1.2.0-1.0.5.el7                                    ol7_addons                    21 M
 criu                                x86_64                   3.12-2.el7                                         ol7_latest                   452 k
 docker-cli                          x86_64                   19.03.1.ol-1.0.0.el7                               ol7_addons                    40 M
 libnet                              x86_64                   1.1.6-7.el7                                        ol7_latest                    57 k
 protobuf-c                          x86_64                   1.0.2-3.el7                                        ol7_latest                    27 k
 runc                                x86_64                   1.0.0-19.rc5.git4bb1fe4.0.4.el7                    ol7_addons                   1.9 M

Transaction Summary
<span class="o">====================================================================================================================================================</span>
Install  1 Package <span class="o">(</span>+7 Dependent packages<span class="o">)</span>

Total download size: 88 M
Installed size: 370 M
<span class="o">[</span>root@wafapplication]# usermod <span class="nt">-aG</span> docker opc
<span class="o">[</span>root@wafapplication]# reboot  
<span class="o">[</span>opc@wafapplication]<span class="nv">$ </span><span class="nb">sudo </span>systemctl start docker
<span class="o">[</span>opc@wafapplication]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--add-port</span><span class="o">=</span>80/tcp
<span class="o">[</span>opc@wafapplication]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
<span class="o">[</span>opc@wafapplication]<span class="nv">$ </span>docker <span class="nt">-it</span> <span class="nt">-d</span> <span class="nt">--name</span> waf <span class="nt">-p</span> 80:80 vulnerables/web-dvwa
<span class="o">[</span>opc@wafapplication]<span class="nv">$ </span>docker ps <span class="nt">-a</span>
CONTAINER ID        IMAGE                  COMMAND             CREATED             STATUS              PORTS                NAMES
9414f813e5e2        vulnerables/web-dvwa   <span class="s2">"/main.sh"</span>          3 minutes ago        Up 3 minutes          0.0.0.0:80-&gt;80/tcp   waf
</code></pre></div></div><p>애플리케이션은 80 포트로 오픈됨으로 ACL 에 80포트가 접근 가능하도록 허용해준 후에 공용 IP로 접속 한다. 최초로 접속 하면 Database를 생성하라는 메시지를 볼 수 있다. MySQL로 생성 되며 이후 자동으로 로그인 페이지로 접속하게 된다. 접근 ID는 admin이다.</p><h4 id="waf-policy-생성">WAF Policy 생성</h4><p>오라클 클라우드의 OCI 콘솔에 로그인 한 후 Security탭에 WAF Policies를 선택 한다. 등록한 WAF Policy가 Compartment에 소속됨으로 적절한 Compartment를 선택하여 준다. Create WAF Policy를 클릭 하면 다음과 같은 화면을 볼 수 있다. <br /> <img src="/image/waf-register/waf-05.png" alt="" /></p><p>Policy Name을 입력 하여 주고 Domains의 Primary Domain에 도메인(waf.korwaf.site)를 등록 하여 준다. WAF Origin에는 Origin을 구분 하기 위한 이름을 입력 하고 URI 부분에 Origin의 공용 IP를 입력 하여 준다. <br /> <img src="/image/waf-register/waf-06.png" alt="" /></p><p>저장 후 몇 분간 Edge에 등록한 WAF Policy를 배포 하기 시작 한다. 전체 Edge에 배포되기 때문에 약간의 시간이 소요 된다. 등록이 완료 되면 다음과 같이 세부 정보 및 메시지를 볼 수 있다. Policy 정보중 CNAME Target을 복사하여 준다. <br /> <img src="/image/waf-register/waf-07.png" alt="" /></p><h4 id="dns-변경">DNS 변경</h4><p>Domain인 제공자가 제공하는 도메인 관리 페이지에서 도메인을 수정하여 주어야 한다. Godaddy에서 관리하는 도메인임으로 godaddy에 로그인 하여 DNS 관리를 선택 한다. 도메인의 레코드 관리에 들어가서 레코드를 추가 하여 준다. 유형은 CNAME을 선택 하고 호스트는 waf를 입력하여 준다.(waf.korwaf.site 라는 도메인을 서비스 하기 위한 것) 지시 방향에 WAF Policy 정보의 CNAME Target을 복사하여 준다. TTL 은 1시간 혹은 1/2 시간을 선택 하여 준다. (해당 시간 안에 변경 사항이 적용 된다) <br /> <img src="/image/waf-register/waf-08.png" alt="" /></p><p>설정이 완료 되면 nslookup 으로 WAF 를 거쳐 가는지 점검하여 본다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Jakes-MacBook-Pro:~ jakekim<span class="nv">$ </span>nslookup waf.korwaf.site
Server:		168.126.63.1
Address:	168.126.63.1#53

Non-authoritative answer:
waf.korwaf.site	canonical name <span class="o">=</span> waf-korwaf-site.o.waas.oci.oraclecloud.net.
waf-korwaf-site.o.waas.oci.oraclecloud.net	canonical name <span class="o">=</span> tm.inregion.waas.oci.oraclecloud.net.
tm.inregion.waas.oci.oraclecloud.net	canonical name <span class="o">=</span> apac-seoul.inregion.waas.oci.oraclecloud.net.
Name:	apac-seoul.inregion.waas.oci.oraclecloud.net
Address: 192.29.19.39
Name:	apac-seoul.inregion.waas.oci.oraclecloud.net
Address: 192.29.18.3
Name:	apac-seoul.inregion.waas.oci.oraclecloud.net
Address: 192.29.19.178
</code></pre></div></div><p>명령어 결과에서 볼 수 있 듯이 lookup 결과 apac-seoul.inregion.waas.oci.oraclecloud.net 으로 트래픽이 가는 것을 볼 수 있다. nslookup 하는 장소에 따라 서울 혹은 일본 등으로 경로가 설정 될 수 있다. 등록이 완료 되었음으로 도메인 주소로 들어가면 정상적으로 웹애플리케이션이 오픈을 확인 하여 준다. <br /> <img src="/image/waf-register/waf-09.png" alt="" /></p><h4 id="기본-waf-설정">기본 WAF 설정</h4><p>OCI의 WAF Policies에 들어가면 등록되어진 WAF Policy를 선택 할 수 있다. 초기는 아무런 설정이 없기 때문에 모든 트래픽이 그대로 Origin으로 전달 되는 형태 이다. 메뉴 옵션을 보면 Origin Management 에서 입력한 Origin에 대한 정보를 볼 수 있으며 IP가 변경 되거나 할 경우 이를 수정하여 주면 된다. Settings 에서는 도메인을 http 혹은 https 로 할지를 선택 할 수 있다. WAF는 애플리케이션 레벨의 방화벽임으로 암호화 되어 전달 되는 데이터를 복호화 할 필요가 있기 때문에 https 로 하는 경우 인증서를 등록 해 주어야 한다. 현재 Web application 이 http 만 서비스 하기 때문에 수정 할 필요는 없다. (https를 설정할 경우 https enable 을 선택) <br /> <img src="/image/waf-register/waf-10.png" alt="" /></p><p>다음은 WAF 의 핵심인 Protection Rules 이다. 외부 공격을 방어하기 위한 패턴 규칙이 약 450여개가 등록 되어 있으며 선별하여 적용이 가능하다. 각 패턴별로 대응하기 위한 액션을 선택 할 수 있다. Off 는 패턴을 보지 않으며 Detect 의 경우 로그만을 기록 하고 트래픽이 전달 되며 block을 선택 하면 해당 패턴의 트래픽은 차단 된다. <br /> <img src="/image/waf-register/waf-11.png" alt="" /> 기본값은 전체가 Off로 설정 되어 있다. Recommendation 탭을 보면 WAF 가 웹 애플리케이션 및 기존 트래픽을 분석 하여 Protection Rule 을 추천 하여 준다. (등록 후 얼마간의 시간이 지나야 추천 Rule 들이 보이게 된다)</p><p>다음 POST에서는 OWASP에 대한 패턴과 WAF가 이를 탐지하는 내용을 보도록 하겠다.</p></div></article><aside class="aside typeset"><h4>Related Posts</h4><ul class="list list--posts"><li class="item item--post"><div class="typeset"><h4><a href="/oke/container/respository/OCIR-basic/">Container Repository</a></h4><small class="small post-meta"> <time datetime="2020-03-06T16:57:53+09:00" class="time"> 06 Mar 2020 </time> </small> <span><br/><h1 id="container-repository">Container Repository</h1><p>Oracle Kubernetes Engine는 Docker를 기반으로 하는 서비스로...</span></div></li><li class="item item--post"><div class="typeset"><h4><a href="/oke/kubernetes/OKE-basic/">OKE-Basic</a></h4><small class="small post-meta"> <time datetime="2020-01-10T15:12:00+09:00" class="time"> 10 Jan 2020 </time> </small> <span><br/><h1 id="oracle-kubernetes">Oracle Kubernetes</h1><p>OKE 는 Oracle Kubernetes Engine 으로 Managed...</span></div></li><li class="item item--post"><div class="typeset"><h4><a href="/edge/dns/dns-service2/">dns-service2</a></h4><small class="small post-meta"> <time datetime="2020-01-10T14:42:00+09:00" class="time"> 10 Jan 2020 </time> </small> <span><br/><h1 id="traffic-management">Traffic Management</h1><p>이전 DNS 관련글에서 DNS zone management 를...</span></div></li></ul><a class="button" href="/feed.xml" title="Subscribe" >Subscribe&nbsp; <svg class="icon" role="img"><use xlink:href="#rss"></use></svg></a><nav class="nav nav--social"><h6>Contact me:</h6><a class="link" target="_blank" href="https://github.com/xers989" title="github"><svg class="icon" role="img"><use xlink:href="#github"></use></svg></a> <a class="link" target="_blank" href="https://www.linkedin.com/in/kyudong-kim-80778033/" title="linkedin"><svg class="icon" role="img"><use xlink:href="#linkedin"></use></svg></a></nav></aside></main><script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-93479534-1', 'auto'); ga('send', 'pageview'); </script><footer class="footer"><div class="container"><nav class="nav nav--footer"><ul class="list list--nav"><li class="item item--nav"> <a href="https://alembic.darn.es/">Adopted Alembic Theme</a></li></ul></nav><div class="copyright typeset"> <small style="color:white;">&copy; Jake Kim 2020</small></div></div></footer></body><link rel="stylesheet" href="/assets/styles.css"><link href="https://fonts.googleapis.com/css?family=Roboto:300" rel="stylesheet"></html>
